## Работа с ssh сервером
SSH это протокол, использующий клиент-серверную модель для аутентификации удаленных систем и обеспечения шифрования данных, обмен которыми происходит в рамках удаленного доступа.
По умолчанию для работы протокола используется TCP-22 порт: на нем сервер (хост) ожидает входящее подключение и, после получения команды и проведения аутентификации, организует запуск клиента, открывая выбранную пользователем оболочку. При необходимости пользователь может менять используемый порт.
Для создания SSH подключения клиент должен инициировать соединение с сервером, обеспечив защищенное соединение и подтвердив свой идентификатор (проверяются соответствие идентификатора с предыдущими записями, хранящимися в RSA-файле, и личные данные пользователя, необходимые для аутентификации). 

#### Проверка работающего ssh сервера.

                        root@astra-01:~# sysytemctl status sshd
                        -bash: sysytemctl: команда не найдена
                        root@astra-01:~# systemctl status sshd
                        ● ssh.service - OpenBSD Secure Shell server
                           Loaded: loaded (/lib/systemd/system/ssh.service; enabled; vendor preset: enabled)
                           Active: active (running) since Wed 2021-11-24 15:45:06 MSK; 1h 12min ago
                         Main PID: 773 (sshd)
                            Tasks: 1 (limit: 4915)
                           CGroup: /system.slice/ssh.service
                                   └─773 /usr/sbin/sshd -D

                        ноя 24 15:45:09 astra-01 sshd[773]: Server listening on :: port 22.
                        ноя 24 15:45:09 astra-01 systemd[1]: Reloading OpenBSD Secure Shell server.
                        ноя 24 15:45:09 astra-01 sshd[773]: Received SIGHUP; restarting.
                        ноя 24 15:45:09 astra-01 systemd[1]: Reloaded OpenBSD Secure Shell server.
                        ноя 24 15:45:09 astra-01 sshd[773]: Server listening on 0.0.0.0 port 22.
                        ноя 24 15:45:09 astra-01 sshd[773]: Server listening on :: port 22.
                        ноя 24 15:47:22 astra-01 sshd[1461]: Accepted password for administrator from 10.60.32.55 port 51987 ssh2
                        ноя 24 15:47:22 astra-01 sshd[1461]: pam_kiosk2(sshd:session): No administrator profile found, trying common profile
                        ноя 24 15:47:22 astra-01 sshd[1461]: pam_kiosk2(sshd:session): No common profile found, further processing stopped
                        ноя 24 15:47:22 astra-01 sshd[1461]: pam_unix(sshd:session): session opened for user administrator by (uid=0)
            
Если сервиса нет его надо установить, если не работает - запустить.

#### Конфигурационный файл: /etc/ssh/ssh_config
Перед звапуском нужно проверить параметр PasswordAuthentication. Значение данного параметра должно быть -  yes. Для разрешения входа по ssh по паролю.

            PasswordAuthentication yes
            
#### Поключение к удаланному ПК
            ssh <login>@<IP ПК>
            ssh administrator@10.0.31.72
            
##### Подключение к удаленному ПК без пароля:
            
1. Создание ключа пользователя:
            
            ssh-keygen -t rsa
            
2. Передача публичного ключа на удаленный ПК
            
            ssh-copy-id -i ~/.ssh/id_rsa.pub user@host
            ssh-copy-id -i ~/.ssh/id_rsa.pub administrator@10.0.31.72
            
 3. Подключение к удаленному ПК через ыыр
            
            ssh administrator@10.0.31.72

## Файловая система Linux
Файловая систе́ма — порядок, определяющий способ организации, хранения и именования данных на носителях информации в компьютерах.

Файловая система определяет формат содержимого и способ физического хранения информации, которую принято группировать в виде файлов. 

Файловая система связывает носитель информации с одной стороны и API для доступа к файлам — с другой. Когда прикладная программа обращается к файлу, она не имеет никакого представления о том, каким образом расположена информация в конкретном файле, так же как и о том, на каком физическом типе носителя (CD, жёстком диске, магнитной ленте, блоке флеш-памяти или другом) он записан. Всё, что знает программа — это имя файла, его размер и атрибуты. Эти данные она получает от драйвера файловой системы. Именно файловая система устанавливает, где и как будет записан файл на физическом носителе (например, жёстком диске).

В основу файловой системы Windows положен диск, символизирующий собой отдельное устройство хранения информации. При этом каждый диск содержит свою собственную файловую систему, корень которой составляет он сам и обозначается буквой. Т.е. запись вида C:\ - обозначает корень файловой системы на диске С, а D:\Работа - папку в корне файловой системы диска D. Подключая к системе новый носитель информации мы получаем еще одну или несколько файловых систем.

В Linuх концепция принципиально иная. Вспомним: все есть файл, дисковые накопители -- это тоже определенный тип файла. Кроме того, файловая система Linuх иерархична, т.е. имеет один единственный корень, обозначаемый символом /.

Но диск, с точки зрения Linux, это тоже файл и может быть расположен в любом месте файловой системы. В нашем случае никто не мешает поместить его на место папки /home, где располагаются пользовательские данные. Такое действие называется монтированием, а место файловой системы, к которому присоединен носитель - точкой монтирования. Таким образом папка /home целиком окажется на втором жестком диске, что будет в какой-то мере аналогично переносу пользовательских данных на диск D.

### Структура файловой системы Linux:

/ — root каталог. Содержит в себе всю иерархию системы;

/bin — здесь находятся двоичные исполняемые файлы. Основные общие команды, хранящиеся отдельно от других программ в системе (прим.: pwd, ls, cat, ps);

/boot — тут расположены файлы, используемые для загрузки системы (образ initrd, ядро vmlinuz);

/dev — в данной директории располагаются файлы устройств (драйверов). С помощью этих файлов можно взаимодействовать с устройствами. К примеру, если это жесткий диск, можно подключить его к файловой системе. В файл принтера же можно написать напрямую и отправить задание на печать;

/etc — в этой директории находятся файлы конфигураций программ. Эти файлы позволяют настраивать системы, сервисы, скрипты системных демонов;

/home — каталог, аналогичный каталогу Users в Windows. Содержит домашние каталоги учетных записей пользователей (кроме root). При создании нового пользователя здесь создается одноименный каталог с аналогичным именем и хранит личные файлы этого пользователя;

/lib — содержит системные библиотеки, с которыми работают программы и модули ядра;

/lost+found — содержит файлы, восстановленные после сбоя работы системы. Система проведет проверку после сбоя и найденные файлы можно будет посмотреть в данном каталоге;

/media — точка монтирования внешних носителей. Например, когда вы вставляете диск в дисковод, он будет автоматически смонтирован в директорию /media/cdrom;

/mnt — точка временного монтирования. Файловые системы подключаемых устройств обычно монтируются в этот каталог для временного использования;

/opt — тут расположены дополнительные (необязательные) приложения. Такие программы обычно не подчиняются принятой иерархии и хранят свои файлы в одном подкаталоге (бинарные, библиотеки, конфигурации);

/proc — содержит файлы, хранящие информацию о запущенных процессах и о состоянии ядра ОС;

/root — директория, которая содержит файлы и личные настройки суперпользователя;

/run — содержит файлы состояния приложений. Например, PID-файлы или UNIX-сокеты;

/sbin — аналогично /bin содержит бинарные файлы. Утилиты нужны для настройки и администрирования системы суперпользователем;

/srv — содержит файлы сервисов, предоставляемых сервером (прим. FTP или Apache HTTP);

/sys — содержит данные непосредственно о системе. Тут можно узнать информацию о ядре, драйверах и устройствах;

/tmp — содержит временные файлы. Данные файлы доступны всем пользователям на чтение и запись. Стоит отметить, что данный каталог очищается при перезагрузке;

/usr — содержит пользовательские приложения и утилиты второго уровня, используемые пользователями, а не системой. Содержимое доступно только для чтения (кроме root);

/var — содержит переменные файлы. Имеет подкаталоги, отвечающие за отдельные переменные. Например, логи будут храниться в /var/log, кэш в /var/cache, очереди заданий в /var/spool/ и так далее.

### Объекты файловой системы Linux

В UNIX-подобных системах все объекты - это файлы.

Файл — это понятие, привычное любому пользователю компьютера. Для пользователя каждый файл — это отдельный предмет, у которого есть начало и конец и который отличается от всех остальных файлов именем и расположением («как называется» и «где лежит»). Файл предназначен для хранения данных любого типа — текстовых, графических, звуковых, исполняемых программ и многого другого. Аналогия файла с предметом позволяет пользователю быстро освоиться при работе с данными в операционной системе.

Каталог — это список ссылок на файлы или другие каталоги. Принято говорить, что каталог содержит в себе файлы или другие каталоги, хотя в действительности он только ссылается на них, физическое размещение данных на диске обычно никак не связано с размещением каталога. Каталог, на который есть ссылка в данном каталоге, называется подкаталогом или вложенным каталогом. Довольно часто вместо термина каталог можно встретить папка (англ. folder).

### Свойства файла.

            administrator@astra-01:~$ pwd
            /home/administrator
            administrator@astra-01:~$ ls -al
            итого 188
            drwxr-x--- 19 administrator administrator  4096 ноя 24 15:45 .
            drwxr-xr-x  5 root          root           4096 сен 16 12:15 ..
            -rw-------  1 administrator administrator   149 сен 16 12:47 .bash_history
            -rw-r--r--  1 administrator administrator   220 сен 16 11:18 .bash_logout
            -rw-r--r--  1 administrator administrator  3526 сен 16 11:18 .bashrc
            drwxr-xr-x  5 administrator administrator  4096 сен 29 15:25 .cache
            drwxr-xr-x  9 administrator administrator  4096 сен 30 09:37 .config
            drwx------  3 administrator administrator  4096 сен 16 11:30 .dbus
            lrwxrwxrwx  1 administrator administrator    17 ноя 24 15:45 Desktop -> Desktops/Desktop1
            drwx------  6 administrator administrator  4096 сен 16 11:30 Desktops
            -rw-r--r--  1 administrator administrator   141 сен 16 11:30 .directory
            -rw-------  1 administrator administrator    22 сен 16 11:30 .dmrc
            drwx------  6 administrator administrator  4096 ноя 24 15:45 .fly

#### Имена файлов и папок.

в Linux ограничены длинной в 256 символов и запретом на / (слеш). Отдельно следует упомянуть о символах . (точка) и ~ (тильда), точка перед именем файла или директории добавляют ему атрибут "скрытый", а тильда после имени добавляет атрибут "архивный" и также делает файл скрытым. Например, .file - скрытый файл, а file~ - архивный.

Еще одна важная особенность - Linux регистрозависимая система, это означает, что file.txt, File.txt и file.TXT - три разных файла!

#### Разширение файла

В Windows тип файла полностью определяется его расширением, от которого также зависит дальнейшее поведение системы при работе с таким файлом. Все знают, что для того, чтобы скрипт мог запускаться, ему нужно присвоить расширение bat или cmd. В Linux поведение системы в отношении того или иного файла зависит от его типа, а для возможности запуска файл должен иметь установленный атрибут "исполняемый".

#### Владелец файла и папок

В Linux у каждого файла и каждого каталога есть два владельца: пользователь и группа. Эти владельцы устанавливаются при создании файла или каталога. Пользователь, который создаёт файл становится владельцем этого файла, а первичная группа, в которую входит этот же пользователь, так же становится владельцем этого файла

#### Права доступа

Еще одним неотъемлемым атрибутом любой файловой системы являются права доступа к файлам и папкам. Linux унаследовал классическую UNIX-систему прав.

Права доступа к файлу (а как мы помним, в Linux все есть файл) хранятся в специальном 16-битовом поле атрибутов файла:

    Тип объекта     	  Особые признаки	                          Права доступа
                          SUID	SGID	sticky	        Пользователь	    Группа	        Остальные
      # # # #	           s	 s	     t	              r w x              r w x            r w x

Первые четыре бита устанавливают флаг типа объекта, они задаются при создании файла и не могут быть изменены. Флаг может иметь следующие значения:

        •	- -- Отсутствие флага - обычный файл
        
        •	l -- Символическая ссылка
        
        •	d -- Директория
        
        •	b -- Блочное устройство
        
        •	c -- Символьное устройство
        
        •	p -- Канал, устройство fifo
        
        •	s -- Unix-сокет
        
Следующие три бита хранят особые признаки, влияющие на запуск исполняемых файлов и некоторые иные права, к ним мы вернемся несколько позже. И наконец следующие девять бит, разделенные на блоки по три бита содержат права доступа к файлу или директории.

Каждый файл в UNIX должен иметь владельца (пользователь, user), группового владельца (группа, group) и остальных пользователей (остальные, other), каждый из этих пользователей может иметь права на чтение (r), запись (w) и исполнение (x).

Применительно к каталогам флаги имеют несколько иной смысл: r - право получения имен файлов в каталоге (но не их атрибутов), x - право получения доступа к файлам и их атрибутам, w - право манипулировать именами файлов, т.е. создавать, удалять, переименовывать. Минимальный разумный набор прав на каталог: rx-, так как только r позволит получить только имена файлов, но не их тип, размер и т.п. Ниже показан пример папки с набором прав r--.

Как нетрудно заметить, w без х не имеет никакого смысла и равносильно его отсутствию.

Запись прав может производиться как в символьной, так и в числовой форме, для этого используют двоичное или восьмеричное (что удобнее) значение установленных битов.

## Основные команды работы с файловой системой и ее объектами.

### Работа в man

                        Раздел	Содержание
                        1	Команды пользователя
                        2	Системные вызовы
                        3	Подпрограммы
                        4	Устройства
                        5	Форматы файлов
                        6	Игры
                        7	Разное
                        8	Системное администрирование
                        n	Новое

Пример:

Мы хотим получить информацию по системному вызову write

            man 2 write

### Навигация и базовые операции

Определеие своего местоположения в файловой системе:

            pwd

Получение списка файлов и папок в текущей директории:

            ls -al 
            ls -lha
            
Полный список ключей можно получить командой:

            ls --help | less
            
 перемещения по файловой системе: cd
 
            cd /etc
            cd ../
            cd ~
            
Поиск файлов и папок

            find name - поиск файлов и папок с именем namе в текущем каталоге
            find /home -type d - поиск в каталоге home каталогов
            find /var/www/deb8.lab -name *.jpg -o -name *.png > ~/image.txt
            find /var/www/deb8.lab -name *.jpg -a -size +100k -o -name *.png -a -size +200k > ~/image.txt
            find ~ -mmin -60 - поиск в домашней директории файлов измененных в течении часа
            find /var/backup -name backup* -mtime +7 -delete - удалить все файлы backup с датой создания более 7 дней

Также команда find позволяет выполнять над найденными файлами произвольные действия, для этого используется ключ -exec command {} \;
            
            find /var/www/deb8.lab -type d -exec chmod 0755 "{}" \; - исправление прав у папок в катаоле сайте
            find /var/www/deb8.lab -type f -exec chmod 0644 "{}" \; - исправление прав у фвйлов в каталоге сайта
            
Вывод последних строк из файла
            
            tail -2 /var/log/syslog
            
            tail -f /var/log/syslog
            
Просмотр содержимого файла

            cat, less, more
            
 ### Работа с файлами и папками
 
 Создание пустых файлов.
            
            touch file1 file2
            
  Создание каталогов.
  
            mkdir my_dir - создание каталога в текущем каталоге
            mkdir -p my_dir1/my_dir2/my_dir3 - создание дерева каталогов
            mkdir -m 0777 my_dir4 - назначение прав вновь созданному каталогу
            
 Копирование файлов и каталогов

            cp file1 my_dir1/
            cp -r dir2 dir1 
            cp -rv dir2 dir1
            
Перемещение файлов и каталогов
            
            mv file1 file2
            mv dir1 /home/dir2

Удаление файлов и каталогов

            rm file1
            rm -fr my_dir1/
Смена (заданее) владельца файла или папки
            
            chown root:root file01
            chown -R root:root my_dir01
            
Смена прав у файла или каталога
            chmod -777 file01
            chmod -R -755 my_dir01 

Смена группы-владельца файла или папки
            
            chgrp my-group file01
            chgrp -R my-group my_dir01

### Работа с пользователями и группами пользователей.
            
            adduser - позволяет создавать пользователя и группу, добавлять пользователя в группу
            deluser - удаляет пользователя 
            
            useradd, userdel, usermod, groupadd, groupdel, groupmod - низко уровневные утилиты для работы с пользователями и группами
       
